var res = {
    "data": [{
        "category": "Local business",
        "category_list": [{"id": "2500", "name": "Local Business"}],
        "location": {
            "street": "",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.8243391821,
            "longitude": 6.76710569427
        },
        "name": "Erftstadt Lechenich",
        "id": "251996818232584"
    }, {
        "category": "Sports/recreation/activities",
        "category_list": [{"id": "186982054657561", "name": "Sports &amp; Recreation"}],
        "location": {
            "street": "Am Schießberg 10",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.824394,
            "longitude": 6.76575
        },
        "name": "Rotbachböcke 05",
        "id": "371924906210332"
    }, {
        "category": "Local business",
        "category_list": [{"id": "192049437499122", "name": "Residence &amp; Other"}],
        "location": {
            "street": "Tillmannshof",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50734",
            "latitude": 50.827380578041,
            "longitude": 6.7685062406416
        },
        "name": "Rittergut Tillmannshof",
        "id": "541100262619662"
    }, {
        "category": "Local business",
        "category_list": [{"id": "165679780146824", "name": "Food &amp; Restaurant"}],
        "location": {
            "street": "Platzstr. 7",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.8241357172,
            "longitude": 6.7673651761487
        },
        "name": "Restaurant Haus Barion",
        "id": "163884863625147"
    }, {
        "category": "Automobiles and parts",
        "category_list": [{"id": "2240", "name": "Automobiles and Parts"}],
        "location": {
            "street": "Wehrstraße 1",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.826252,
            "longitude": 6.766991
        },
        "name": "Audison Germany",
        "id": "1390482694548064"
    }, {
        "category": "Non-profit organization",
        "category_list": [{"id": "2603", "name": "Non-Profit Organization"}],
        "location": {
            "street": "Kiesstraße 20",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.823495738828,
            "longitude": 6.7638829055932
        },
        "name": "Malteser Erftstadt",
        "id": "266639403382550"
    }, {
        "category": "Automobiles and parts",
        "category_list": [{"id": "2240", "name": "Automobiles and Parts"}],
        "location": {
            "street": "Wehrstraße 1",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.826252,
            "longitude": 6.766991
        },
        "name": "Hertz Audio Video Germany",
        "id": "486838584749868"
    }, {
        "category": "Business services",
        "category_list": [{"id": "199182823425834", "name": "Electrician"}, {
            "id": "139823692748565",
            "name": "Computers &amp; Electronics"
        }],
        "location": {
            "street": "Chorweg 11",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.824983,
            "longitude": 6.769661
        },
        "name": "Elektro Kaufmann",
        "id": "367807786620080"
    }, {
        "category": "Engineering/construction",
        "category_list": [{"id": "2251", "name": "Engineering/Construction"}],
        "location": {
            "street": "Feldstr. 7",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.82435,
            "longitude": 6.768901
        },
        "name": "Udo Röbkes Bauunternehmung",
        "id": "795648140498851"
    }, {
        "category": "Non-profit organization",
        "category_list": [{"id": "2603", "name": "Non-Profit Organization"}],
        "location": {
            "street": "Kiesstraße 20",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.823495738828,
            "longitude": 6.7638829055932
        },
        "name": "Malteser Jugend Erftstadt",
        "id": "258413294219413"
    }, {
        "category": "Local business",
        "category_list": [{"id": "2500", "name": "Local Business"}],
        "location": {
            "street": "Remigiusstr. 11",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.825902,
            "longitude": 6.763955
        },
        "name": "Zurich Generalagentur Reinhold Bersch",
        "id": "364500333615868"
    }, {
        "category": "Spas/beauty/personal care",
        "category_list": [{"id": "139225689474222", "name": "Spa, Beauty &amp; Personal Care"}],
        "location": {
            "street": "Tillmannsweg 2",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.827131,
            "longitude": 6.768508
        },
        "name": "Fachfusspflege Kerstin Golka",
        "id": "139489129533674"
    }, {
        "category": "Hotel",
        "category_list": [{"id": "164243073639257", "name": "Hotel"}],
        "location": {
            "street": "Am Schießberg 3",
            "city": "Erftstadt",
            "state": "",
            "country": "Germany",
            "zip": "50374",
            "latitude": 50.824486,
            "longitude": 6.766924
        },
        "name": "Haus Richrath Hotel Garni",
        "id": "474531085901258"
    }],
    "paging": {"next": "https://graph.facebook.com/v2.3/search?type=place&q&center=50.8295269,6.7725819&distance=1000&access_token=857640940981214|c33iHywb6-8-r1x5l-BBOviNtTQ&limit=25&offset=25&__after_id=enc_AdAe0CUUvju7VQZBlEdpx4MGxTlZCd2Oj8EAZBJ13gEa642g8d4noQBHpB1FjAIsuGhgmZCggdzCll3ficvkQSluNEzs"}
}


require("../model");
var async = require('async');

var mongoose = require('mongoose'),
    Page = mongoose.model('Page');


Page.find({}, function(err, results){

    var asyncQueries = [];
    results.forEach(function(item){
        asyncQueries.push(function(callback){
            item.geo_point_mongo = {
                type: "Point",
                coordinates: [
                    item.location.latitude, item.location.longitude
                ]
            };
            item.save(function(err, response){
              callback();
            })
        })
    });
    async.series(asyncQueries, function(){
        console.log("all Done");
    })

});








/*var FB = require('fb');
var FB_APP_ID = "857640940981214";
var FB_APP_SECRET = "469300d9c3ed9fe6ff4144d025bc1148";

var authenticateWithFB = function (cb) {
    FB.api('oauth/access_token', {
        client_id: FB_APP_ID,
        client_secret: FB_APP_SECRET,
        grant_type: 'client_credentials'
    }, function (res) {
        if (!res || res.error) {
            console.log(!res ? 'error occurred' : res.error);
            return;
        }
        FB.setAccessToken(res.access_token);
        console.log("got access token: " + res.access_token);
        cb();

    });
};
authenticateWithFB(function(){
    FB.api('/'+212917078724761, 'get', {access_token: FB.getAccessToken()}, function(response){
        console.log(response);
    })
});*/


/*
var Client = require('node-rest-client').Client;
client = new Client();

var url = "https://graph.facebook.com/v2.3/search?limit=25&offset=25&type=place&center=50.824394,6.76575&distance=1000&__after_id=enc_AdAasZCvJeLGPXNQMhjFOv9UPbhusHbPv1ihD44sgoONibYmbZCZA2qEpSp3jZAGk0bNZB4SoSAcNRxDHlFjKafLJIcUp";
var args = {};

client.get(url, args, function(data, reponse){
    console.log(data.toString());
});
*/
