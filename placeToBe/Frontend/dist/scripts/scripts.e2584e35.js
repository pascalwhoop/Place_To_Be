"use strict";angular.module("frontendApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("frontendApp").controller("MainCtrl",["$scope",function(a){a.filter={city:{name:"cologne",location:null},time:"now"},a.eventSourceUrl="https://placetobe-koeln.azurewebsites.net/api/event"}]),angular.module("frontendApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("frontendApp").directive("placetobeHeatmap",["$http",function(a){return{link:function(b,c,d){function e(a,b,c){return null!==b&&(a=Math.max(a,b)),null!==c&&(a=Math.min(a,c)),a}function f(a){return a*(Math.PI/180)}function g(a){return a/(Math.PI/180)}function h(){this.pixelOrigin_=new google.maps.Point(l/2,l/2),this.pixelsPerLonDegree_=l/360,this.pixelsPerLonRadian_=l/(2*Math.PI)}function i(){var a=50,b=1<<k.getZoom(),c=k.getCenter(),d=google.maps.geometry.spherical.computeOffset(c,1e4,90),e=new h,f=e.fromLatLngToPoint(c),g=e.fromLatLngToPoint(d),i=new google.maps.Point(f.x*b,f.y*b),j=new google.maps.Point(g.x*b,g.y*b),l=Math.abs(i.x-j.x)/1e4,m=Math.floor(a*l);return console.log(m),m}var j=new google.maps.Geocoder,k=null,l=256;b.$on("mapInitialized",function(a,c){k=c,j.geocode({address:b.city.name},function(a,b){b==google.maps.GeocoderStatus.OK&&(c.setCenter(a[0].geometry.location),c.fitBounds(a[0].geometry.bounds))}),m(b.city.name,b.time,n)});var m=function(c,d,e){a.get(b.eventSource+"/filter/"+c+"/"+d).success(function(a,b,c,d){e(a)})},n=function(a){var b=[];a.forEach(function(a){o(a,b)}),b=new google.maps.MVCArray(b);var c=new google.maps.visualization.HeatmapLayer({data:b,map:k,radius:i()});c.setMap(k),google.maps.event.addListener(k,"zoom_changed",function(){c.setOptions({radius:i()})})},o=function(a,b){for(var c=1e-5*Math.pow(a.attending_count,.66666),d=0;d<Math.ceil(a.attending_count/100);d++){var e=c*Math.random(),f=Math.random()*Math.PI*2,g=a.locationCoordinates.coordinates[0]+Math.cos(f)*e,h=a.locationCoordinates.coordinates[1]+Math.sin(f)*e,i=new google.maps.LatLng(g,h);b.push(i)}};h.prototype.fromLatLngToPoint=function(a,b){var c=this,d=b||new google.maps.Point(0,0),g=c.pixelOrigin_;d.x=g.x+a.lng()*c.pixelsPerLonDegree_;var h=e(Math.sin(f(a.lat())),-.9999,.9999);return d.y=g.y+.5*Math.log((1+h)/(1-h))*-c.pixelsPerLonRadian_,d},h.prototype.fromPointToLatLng=function(a){var b=this,c=b.pixelOrigin_,d=(a.x-c.x)/b.pixelsPerLonDegree_,e=(a.y-c.y)/-b.pixelsPerLonRadian_,f=g(2*Math.atan(Math.exp(e))-Math.PI/2);return new google.maps.LatLng(f,d)}},templateUrl:"scripts/directives/heatmapdirective.html",restrict:"E",scope:{city:"=",time:"=",eventSource:"="}}}]),angular.module("frontendApp").factory("gaussianService",function(){var a=function(a){var b=Math.abs(a),c=1/(1+b/2),d=c*Math.exp(-b*b-1.26551223+c*(1.00002368+c*(.37409196+c*(.09678418+c*(-.18628806+c*(.27886807+c*(-1.13520398+c*(1.48851587+c*(-.82215223+.17087277*c)))))))));return a>=0?d:2-d},b=function(b){if(b>=2)return-100;if(0>=b)return 100;for(var c=1>b?b:2-b,d=Math.sqrt(-2*Math.log(c/2)),e=-.70711*((2.30753+.27061*d)/(1+d*(.99229+.04481*d))-d),f=0;2>f;f++){var g=a(e)-c;e+=g/(1.1283791670955126*Math.exp(-(e*e))-e*g)}return 1>b?e:-e},c=function(a,b){return e(b/a,1/a)},d=function(a,b){if(0>=b)throw new Error("Variance must be > 0 (but was "+b+")");this.mean=a,this.variance=b,this.standardDeviation=Math.sqrt(b)};d.prototype.pdf=function(a){var b=this.standardDeviation*Math.sqrt(2*Math.PI),c=Math.exp(-Math.pow(a-this.mean,2)/(2*this.variance));return c/b},d.prototype.cdf=function(b){return.5*a(-(b-this.mean)/(this.standardDeviation*Math.sqrt(2)))},d.prototype.add=function(a){return e(this.mean+a.mean,this.variance+a.variance)},d.prototype.sub=function(a){return e(this.mean-a.mean,this.variance+a.variance)},d.prototype.scale=function(a){return e(this.mean*a,this.variance*a*a)},d.prototype.mul=function(a){if("number"==typeof a)return this.scale(a);var b=1/this.variance,d=1/a.variance;return c(b+d,b*this.mean+d*a.mean)},d.prototype.div=function(a){if("number"==typeof a)return this.scale(1/a);var b=1/this.variance,d=1/a.variance;return c(b-d,b*this.mean-d*a.mean)},d.prototype.ppf=function(a){return this.mean-this.standardDeviation*Math.sqrt(2)*b(2*a)};var e=function(a,b){return new d(a,b)};return e});